/* autogenerated by webmerge (join context) */
;
//***********************************************************
// (c) 2016 by Marcel Greter
// AstroJS VSOP87 utility lib
// https://github.com/mgreter/ephem.js
//***********************************************************
(function(self) {

	// generic vsop87 solver (pass coefficients and time)
	// this is basically a one to one translation from the official
	// fortran code in vsop87.f at around line 185. Only change is
	// that I took out the multiplication for the summands and apply
	// it after the sum has been calculated. IMO this should be a bit
	// faster than the original implementation, but not sure if the
	// precision will suffer from that change.
	if (typeof self.vsop87 !== "function") {
		// only define once in global scope
		// otherwise we overwrite loaded data
		self.vsop87 = function vsop87(coeffs, time)
		{
			// want 1000 JY (KJY)
			var t = time / 1000, result = {},
			    u, cu, tt = [0, 1, t, t*t];
			// reuse old multiplications
			// fortran t(x) array starts at -1!
			// therefore t(it) = tt[it+1] (js)
			tt[4] = tt[3] * t, tt[5] = tt[4] * t, tt[6] = tt[5] * t;
			// do a cheap test if coefficients are from the main vsop87
			// theories. All other [a-e] only need 3 to calculate the
			// full 6 elements (velocity is calculated from position).
			var main = 'a' in coeffs;
			// calculate poisson series
			for (var v in coeffs) {
				// init result holders
				result[v] = 0;
				if (!main) result['v'+v] = 0;
				// loop all coefficients for all powers (t^0, t^1, t^2, etc.)
				for (var it = 0, sum = 0, dsum = 0; it < coeffs[v].length; it += 1) {
					var pow_sum = 0, dpow_sum = 0, coeff = coeffs[v][it];
					for (var i = 0, cl = coeff.length; i < cl; i += 3) {
						// assign coefficients as in fortran code
						// `read (lu,1002,err=500) a,b,c` (line 187)
						var a = coeff[i+0], b = coeff[i+1], c = coeff[i+2];
						// `u=b+c*t(1)` and `cu=dcos(u)`
						u = b + c * t, cu = Math.cos(u);
						// `r(ic)=r(ic)+a*cu*t(it)`
						pow_sum += a * cu * tt[it+1];
						// condition for `if (iv.eq.0) goto 200`
						// calculation for `t(it)*a*c*su` (line 194)
						// note to myself: tt[it]*it != tt[it+1]
						if (!main) dpow_sum += tt[it]*it*a*cu - tt[it+1]*a*c*Math.sin(u);
					}
					// this is the step for r(ic)=r(ic)+(...) (line 191)
					result[v] += pow_sum; /*t(it)*/;
					if (!main) result['v'+v] += dpow_sum / 365250;
				}
			}
			// normalize angles
			if ('L' in result) {
				result.L = result.L % (Math.PI * 2);
				if (result.L < 0) result.L += (Math.PI * 2);
			}
			if ('l' in result) {
				result.l = result.l % (Math.PI * 2);
				if (result.l < 0) result.l += (Math.PI * 2);
			}
			if ('b' in result) {
				result.n = result.n % (Math.PI * 2);
				if (result.n < 0) result.n += (Math.PI * 2);
			}
			// return result
			return result;
		}

	}

	/*
	// position = heliocentric
	function vsop2fk5(position, JD)
	{
		var LL, cos_LL, sin_LL, T, delta_L, delta_B, B;

		// get julian centuries from 2000
		T = (JD - 2451545.0) / 36525.0;

		LL = position.L + (- 1.397 * DEG2RAD - 0.00031 * DEG2RAD * T) * T;
		// LL = ln_deg_to_rad(LL);
		cos_LL = Math.cos(LL);
		sin_LL = Math.sin(LL);
		// B = ln_deg_to_rad(position.B);

		delta_L = (-0.09033 / 3600.0) + (0.03916 / 3600.0) *
				(cos_LL + sin_LL) * Math.tan(B);
		delta_B = (0.03916 / 3600.0) * (cos_LL - sin_LL);

		return {
			l: L + delta_L,
			b: B + delta_B
		};
	}
	*/

})(self);;
(function(vsop87) {;

function vsop87_mer(jy) { return vsop87(vsop87_mer.coeffs, jy); }
vsop87_mer.coeffs = {
	a: [[0.38709830982,0,0]],
	L: [[4.4026088424,0,0],[26087.9031415742,0,0]],
	k: [[0.0446605976,0,0],[0.00552114624,3.14159265359,0]],
	h: [[0.20072331368,0,0],[0.00143750118,0,0]],
	q: [[0.04061563384,0,0],[0.00065433117,0,0]],
	p: [[0.04563550461,0,0],[0.00127633657,3.14159265359,0]]
}; // assign to function
vsop87.mer = vsop87_mer; // export function
;

function vsop87_ven(jy) { return vsop87(vsop87_ven.coeffs, jy); }
vsop87_ven.coeffs = {
	a: [[0.72332981996,0,0]],
	L: [[3.17614669689,0,0],[10213.285546211,0,0]],
	k: [[0.00449282133,3.14159265359,0],[0.00031259019,0,0]],
	h: [[0.00506684726,0,0],[0.00036121239,3.14159265359,0]],
	q: [[0.00682410142,0,0],[0.00138133826,0,0]],
	p: [[0.02882285775,0,0],[0.00040384791,3.14159265359,0]]
}; // assign to function
vsop87.ven = vsop87_ven; // export function
;

function vsop87_emb(jy) { return vsop87(vsop87_emb.coeffs, jy); }
vsop87_emb.coeffs = {
	a: [[1.00000101778,0,0]],
	L: [[1.75347045953,0,0],[6283.0758499914,0,0]],
	k: [[0.0037408165,3.14159265359,0],[0.00082267418,3.14159265359,0]],
	h: [[0.01628447663,0,0],[0.00062029655,3.14159265359,0]],
	q: [[4.699e-007,1.03836320801,775.522611324],[0.00113468869,3.14159265359,0]],
	p: [[4.8408e-007,5.76054381234,775.522611324],[0.00010180375,0,0]]
}; // assign to function
vsop87.emb = vsop87_emb; // export function
;

function vsop87_mar(jy) { return vsop87(vsop87_mar.coeffs, jy); }
vsop87_mar.coeffs = {
	a: [[1.52367934191,0,0]],
	L: [[6.20347611291,0,0,0.00027745033,5.97049541372,3.523118349],[3340.61242669981,0,0]],
	k: [[0.08536560252,0,0],[0.00376330152,0,0],[0.00024657776,3.14159265359,0]],
	h: [[0.03789973236,3.14159265359,0],[0.00624657465,0,0],[0.00015529482,0,0]],
	q: [[0.01047042574,0,0],[0.00017138526,0,0]],
	p: [[0.01228449307,0,0],[0.00108020083,3.14159265359,0]]
}; // assign to function
vsop87.mar = vsop87_mar; // export function
;

function vsop87_jup(jy) { return vsop87(vsop87_jup.coeffs, jy); }
vsop87_jup.coeffs = {
	a: [[5.20260319132,0,0,0.00069070151,5.72686174779,632.7837393132,0.00032272046,1.90381613358,103.0927742186,0.00031138634,5.46486196547,949.1756089698,0.0002181433,0.70025220178,419.4846438752,0.00025558941,6.15962426898,7.1135470008,0.00020585372,5.98131661466,316.3918696566,0.00011836569,0.41496888665,735.8765135318,0.00014633106,5.20240925402,1265.5674786264],[0.00010177614,4.46063225487,7.1135470008]],
	L: [[0.59954649739,0,0,0.00573506125,1.4439630642,7.1135470008,0.00062308554,3.41857056095,103.0927742186,0.00032251188,1.01358443926,632.7837393132,0.00023791184,1.27622244841,316.3918696566,0.00013391386,2.32518571601,419.4846438752,0.0001173059,0.74641135653,949.1756089698],[529.6909650946,0,0,0.00228875491,6.02639570653,7.1135470008],[0.00047224495,4.32142959829,7.1135470008,0.00014837133,3.14159265359,0]],
	k: [[0.04698572124,0,0,0.0006528701,5.14135675663,103.0927742186,0.00038006128,2.03714771852,7.1135470008,0.00013518804,2.94820975394,110.2063212194,0.00010740857,4.85106997988,419.4846438752],[0.00113010377,0,0,0.00010303903,0.33250058601,7.1135470008],[0.00010930126,3.14159265359,0]],
	h: [[0.01200385748,0,0,0.00064278139,0.39928981461,103.0927742186,0.00037689163,0.46902799622,7.1135470008,0.00012686502,1.52173271472,110.2063212194,0.00010468075,0.14414631816,419.4846438752],[0.0021714936,0,0,0.00010164439,5.05135857516,7.1135470008]],
	q: [[0.00206561098,3.14159265359,0],[0.00031340156,3.14159265359,0]],
	p: [[0.01118377157,0,0],[0.00023427562,3.14159265359,0]]
}; // assign to function
vsop87.jup = vsop87_jup; // export function
;

function vsop87_sat(jy) { return vsop87(vsop87_sat.coeffs, jy); }
vsop87_sat.coeffs = {
	a: [[9.55490959574,0,0,0.03363448736,6.0097367346,316.3918696566,0.00354492417,5.81482665415,103.0927742186,0.00289062242,3.01816520038,7.1135470008,0.0030846159,2.55488166399,632.7837393132,0.00149912686,3.86270340354,419.4846438752,0.00143605062,4.8591750507,213.299095438,0.00146816895,0.07437685257,846.0828347512,0.00142075017,2.32273369924,949.1756089698,0.0007341234,3.55846055429,735.8765135318,0.00081821669,3.45006412768,110.2063212194,0.00054284469,5.12517048023,206.1855484372,0.00067160409,2.06145646779,1265.5674786264,0.00038450594,3.28109764968,1052.2683831884,0.00040372154,6.12336876226,309.2783226558,0.0003786136,2.71073622362,323.5054166574,0.00032196433,1.80319862777,1581.959348283,0.00024471393,4.81178790264,522.5774180938,0.00020860007,3.01028862668,1368.660252845,0.00018549188,0.87944999842,6069.7767545534,0.00013849443,4.65107330724,838.9692877504,0.00017342295,2.30290130287,9999.986450773,0.00015605088,1.55158323786,1898.3512179396,0.00011535604,2.74021432418,1685.0521225016,0.00013277748,3.34520712627,277.0349937414],[0.00115108584,1.31913907888,7.1135470008,0.00020477409,5.54887034001,419.4846438752,0.00019395929,3.30487092881,213.299095438,0.00017963494,1.85653949491,110.2063212194,0.00016133051,1.54311529056,309.2783226558,0.00014944585,1.01717765228,323.5054166574,0.00014543221,0.53828819496,206.1855484372],[0.00023754277,5.89931397638,7.1135470008]],
	L: [[0.8740167565,0,0,0.01411655077,4.58553469006,7.1135470008,0.00259784547,4.43343036691,316.3918696566,0.00149861955,0.26851062811,103.0927742186,0.00071179955,4.15641496284,632.7837393132,0.00031452707,5.46081855509,419.4846438752,0.0002654809,3.88757160092,949.1756089698,0.000166785,0.46554866763,206.1855484372,0.00012478276,4.43427037492,110.2063212194,0.0001464809,0.80489143062,529.6909650946,0.00012249591,5.17809413714,735.8765135318,0.00014601573,1.56514416532,3.9321532631,0.00013067003,4.44777987188,14.2270940016,0.00012172375,2.85599565676,213.299095438,0.00012994507,5.98000018071,11.0457002639,0.00010143831,4.81233412109,846.0828347512,0.00011053979,3.62184165245,1265.5674786264],[213.299095438,0,0,0.00563352798,2.8847856166,7.1135470008,0.00014171331,1.28319722079,103.0927742186,0.00010437362,2.74781046876,14.2270940016],[0.00116235667,1.17971682406,7.1135470008,0.00036659741,0,0],[0.00016010484,5.73932776276,7.1135470008]],
	k: [[0.00296003595,3.14159265359,0,0.00155326496,5.16402515606,7.1135470008,0.00197268763,0.59616692002,529.6909650946,0.00126322249,0.86230560136,213.299095438,0.00065050158,5.14656256627,103.0927742186,0.00045181084,1.69923556056,419.4846438752,0.00031292923,5.75285406117,110.2063212194,0.00027272443,3.0089088392,206.1855484372,0.00016225491,1.4279916691,735.8765135318,0.0001247418,1.09305375439,316.3918696566],[0.00529602626,3.14159265359,0,0.00041825363,3.46891617076,7.1135470008],[0.00030928405,0,0]],
	h: [[0.05542964254,0,0,0.00154553684,3.5944713223,7.1135470008,0.00196887619,5.31528897782,529.6909650946,0.00124537423,5.6029550572,213.299095438,0.00068728896,0.46796586407,103.0927742186,0.00044695611,3.26423001884,419.4846438752,0.0003298126,4.13131540179,110.2063212194,0.00026520042,4.52478837442,206.1855484372,0.00016256954,3.02503473426,735.8765135318],[0.00375593887,3.14159265359,0,0.00041501368,1.90158625579,7.1135470008],[0.00031990236,3.14159265359,0]],
	q: [[0.00871747436,3.14159265359,0],[0.00080171499,0,0]],
	p: [[0.01989147301,0,0],[0.00059439766,0,0]]
}; // assign to function
vsop87.sat = vsop87_sat; // export function
;

function vsop87_ura(jy) { return vsop87(vsop87_ura.coeffs, jy); }
vsop87_ura.coeffs = {
	a: [[19.21844606178,0,0,0.0803047624,1.40140954803,454.9093665273,0.02068375131,1.67626096637,138.5174968707,0.00406413575,5.21303965129,380.12776796,0.00365190162,1.75064255586,984.6003316219,0.00391818405,2.05935807638,1.4844727083,0.00313720406,2.19852745462,74.7815985673,0.00148020073,4.84763548983,63.7358983034,0.00124336026,1.34101096123,11.0457002639,0.00120436873,0.15931700196,277.0349937414,0.00102755162,0.89451486294,351.8165923087,0.00090078269,0.33585778387,73.297125859,0.0006192097,3.4581808792,456.3938392356,0.00045935079,4.6428671115,202.2533951741,0.00058841165,2.48705383463,453.424893819,0.00053293996,0.5099564439,109.9456887885,0.00051844499,2.55536031544,6208.2942514241,0.00050469671,1.89418222433,415.5524906121,0.00048838076,3.97801797335,10138.5039476437,0.00034892404,5.75418250485,909.8187330546,0.00032917894,0.70483800006,2.9689454166,0.00036972301,0.17475135689,36.6485629295,0.00028704578,1.39041828806,35.1640902212,0.00029696881,0.67903436338,146.594251718,0.00021391939,0.02845030511,340.7708920448,0.0001947827,2.1004139056,1514.2912967165,0.00022997542,1.53103267798,447.7958195265,0.0002303434,4.41961897942,462.0229135281,0.00020141604,2.67711439002,305.3461693927,0.00018767795,4.43338724151,149.5631971346,0.00021559916,3.58530830565,554.0699874828,0.00012998808,2.85105295526,127.4717966068,0.00016880093,0.8479805848,183.2428146475,0.00014762015,1.55212266318,145.6310438715,0.00015930221,3.73134883667,140.001969579,0.00014478423,4.9498312979,131.4039498699,0.0001515997,2.76239188887,137.0330241624,0.00010515353,1.70301075392,479.2883889155,0.00012687891,1.58735697797,71.8126531507,0.0001307766,4.23675214362,381.6122406683,0.00011020208,3.19000442755,3.9321532631,0.0001101356,3.543073512,835.0371344873,0.00011334332,5.9796356063,316.3918696566],[0.00018892174,5.14166599806,11.0457002639,0.00018428974,0.90876002089,984.6003316219,0.00012155731,5.07129450662,351.8165923087,0.00011411513,0.08109503303,63.7358983034]],
	L: [[5.48129387159,0,0,0.01503941337,3.62721239702,1.4844727083,0.00341045477,6.11377091373,454.9093665273,0.0007557155,0.10254572902,138.5174968707,0.00061937506,2.26973190883,2.9689454166,0.00059722283,2.84455045894,11.0457002639,0.00018867012,5.43708395337,529.6909650946,0.00017129222,0.18104766503,984.6003316219,0.00016468518,5.36717518314,63.7358983034,0.00014543819,4.7364457576,3.9321532631,0.00014437567,1.91368590597,73.297125859,0.00013047912,1.74402938964,36.6485629295,0.00012930477,1.77673119432,277.0349937414],[74.7815985673,0,0,0.00024451511,1.71261369505,1.4844727083]],
	k: [[0.04595132376,3.14159265359,0,0.00274532742,0.59960944961,529.6909650946,0.00209611522,1.99913587697,1.4844727083,0.00136013862,5.48189691557,74.7815985673,0.0011637991,2.20321839185,380.12776796,0.00061367654,0.87377399008,213.299095438,0.00025955084,4.91660280043,11.0457002639,0.00028383762,2.48454325825,63.7358983034,0.00015021315,0.76594621932,2.9689454166,0.00013311384,0.94943515364,1059.3819301892],[0.00018344115,0,0]],
	h: [[0.00563791307,0,0,0.00274676149,5.31178834743,529.6909650946,0.00210407426,0.42744224313,1.4844727083,0.00136132837,3.91136489012,74.7815985673,0.00116288289,3.77434233468,380.12776796,0.00061308823,5.58629337039,213.299095438,0.00025966791,3.35174050484,11.0457002639,0.00028214307,4.05785385739,63.7358983034,0.00014988819,5.47840346834,2.9689454166,0.00013315732,5.66170904346,1059.3819301892],[0.0007496435,3.14159265359,0]],
	q: [[0.00185915075,0,0],[0.00012449382,3.14159265359,0]],
	p: [[0.00648617008,0,0],[0.00011744733,3.14159265359,0]]
}; // assign to function
vsop87.ura = vsop87_ura; // export function
;

function vsop87_nep(jy) { return vsop87(vsop87_nep.coeffs, jy); }
vsop87_nep.coeffs = {
	a: [[30.11038686942,0,0,0.14818172119,1.57105922541,491.5579294568,0.03597274341,1.84552690821,175.1660598002,0.00832345688,5.19528065894,1.4844727083,0.0069430399,1.92062235445,1021.2488945514,0.00462318447,0.16921610518,36.6485629295,0.00144701407,3.3696710207,453.424893819,0.0018566634,1.07141029917,388.4651552382,0.00105687575,3.4844777292,73.297125859,0.00101174992,2.72476929716,6244.9428143536,0.0009553057,4.14819625611,10175.1525105732,0.0007839139,0.48629941459,493.0424021651,0.00069569587,3.84742919656,2.9689454166,0.00072554259,5.79767484989,490.0734567485,0.0004687645,3.85081593965,137.0330241624,0.000569767,3.65157409569,109.9456887885,0.0005078132,4.51488159732,35.1640902212,0.00037417236,2.27030739588,1550.939859646,0.00042415052,1.70067649012,484.444382456,0.0004253901,4.58925849638,498.6714764576,0.0003179202,3.25530033905,983.1158589136,0.00031426284,3.82119024473,146.594251718,0.00025671325,1.72232760443,182.279606801,0.00025130259,5.11703371894,168.0525127994,0.00026057248,0.60013829511,350.3321196004,0.00024649447,6.00875947773,316.3918696566,0.00021792087,2.62371458707,111.4301614968,0.0001988739,4.72200680846,71.8126531507,0.00018971774,0.76073169118,176.6505325085,0.00017669174,6.07111527239,173.6815870919,0.00017938336,3.98996043594,183.2428146475,0.00017526509,3.41680716222,666.723989257,0.00014186982,0.39055348945,38.1330356378,0.00013243147,1.48517883768,454.9093665273,0.00011035877,0.32439741096,601.7642506762,0.00011159386,4.90170178578,108.4612160802,0.00010396544,4.15850491413,219.891377577],[0.00035017221,1.07792431879,1021.2488945514,0.00021981792,5.24159938374,388.4651552382,0.0001698372,2.88749614679,498.6714764576,0.00016926224,3.40079518197,484.444382456,0.00013646732,3.31887794551,1.4844727083,0.00010242826,0.02106658542,182.279606801,0.00010028658,0.53331428424,168.0525127994]],
	L: [[5.31188628676,0,0,0.01017628072,0.48586478491,1.4844727083,0.00441710236,0.00020868462,491.5579294568,0.00092919548,0.27470534254,175.1660598002,0.00041703723,5.41098453927,2.9689454166,0.00021806166,0.34972092081,1021.2488945514,0.00016297466,4.88440388945,36.6485629295],[38.1330356378,0,0,0.00016569412,4.86311838543,1.4844727083]],
	k: [[0.00599977571,0,0,0.00343810387,0.59989432818,529.6909650946,0.0013623298,5.31190360139,38.1330356378,0.00131042161,2.54238248127,453.424893819,0.00076137558,0.87421757435,213.299095438,0.00059960933,5.1374603101,1.4844727083,0.00034074986,2.81681245358,137.0330241624,0.00016663303,0.94954464976,1059.3819301892,0.00015893727,3.92171062449,2.9689454166]],
	h: [[0.00669242413,0,0,0.00344034784,5.31201105782,529.6909650946,0.00136278888,3.74103613444,38.1330356378,0.00131043136,4.11313570675,453.424893819,0.00076068364,5.58664660018,213.299095438,0.00059736086,3.56479788019,1.4844727083,0.00034070791,4.38749299404,137.0330241624,0.00016671327,5.66175544286,1059.3819301892,0.00015834646,2.35068672532,2.9689454166]],
	q: [[0.01029147819,3.14159265359,0]],
	p: [[0.01151683985,0,0]]
}; // assign to function
vsop87.nep = vsop87_nep; // export function
;
})(vsop87)
/* crc: A83998397EDBE10E594B16E3B7A99EF3 */
